# AI Agents

åœ¨é€™å ‚èª²ä¸­ï¼Œä½ å°‡å­¸ç¿’å¦‚ä½•å»ºç«‹ä¸€å€‹èƒ½å¤ ...è‡ªè¡Œæ±ºç­–ä¸¦åŸ·è¡Œæ“ä½œï¼Œè€Œä¸éœ€è¦æŒçºŒçš„äººå·¥å¹²é çš„ AI å¯¦é«”ï¼Ÿæ²’éŒ¯ï¼ŒAI Agents èƒ½å¤ ç¨ç«‹å®Œæˆç‰¹å®šä»»å‹™ã€‚

---

[![Agents explainer video](https://img.youtube.com/vi/Btkmw1Bosh0/0.jpg)](https://youtu.be/Btkmw1Bosh0?feature=shared)

_â¬†ï¸é»æ“Šåœ–ç‰‡è§€çœ‹å½±ç‰‡â¬†ï¸_

AI Agents è®“ LLMs å¾åŠ©ç†é€²åŒ–ç‚ºèƒ½å¤ ä»£è¡¨ä½¿ç”¨è€…æ¡å–è¡Œå‹•çš„å¯¦é«”ã€‚é€™äº›ä»£ç†ç”šè‡³èƒ½å¤ èˆ‡å…¶ä»–ä»£ç†äº’å‹•ä»¥å®Œæˆä»»å‹™ã€‚ä¸€å€‹ä»£ç†çš„é—œéµç‰¹å¾µåŒ…æ‹¬ä¸€å®šç¨‹åº¦çš„**è‡ªä¸»æ€§**ï¼Œå…è¨±ä»£ç†æ ¹æ“šå…¶ç¨‹å¼è¨­è¨ˆä¾†å•Ÿå‹•è¡Œå‹•ï¼Œé€²è€Œå¯¦ç¾åŸºæ–¼é å®šç›®æ¨™çš„**æ±ºç­–èƒ½åŠ›**ã€‚æ­¤å¤–ï¼Œå®ƒå€‘é‚„å…·æœ‰**é©æ‡‰æ€§**ï¼Œèƒ½å¤ é€šéå­¸ç¿’å’Œèª¿æ•´ä¾†éš¨æ™‚é–“æå‡è¡¨ç¾ã€‚

åœ¨æ§‹å»ºä»£ç†æ™‚éœ€è¦è¨˜ä½çš„ä¸€å€‹é—œéµé»æ˜¯ï¼Œå®ƒå€‘å°ˆæ³¨æ–¼åŸ·è¡Œå–®ä¸€ä»»å‹™ã€‚ä½ éœ€è¦å„˜å¯èƒ½ç¸®å°å®ƒå€‘çš„ç”¨é€”ç¯„åœã€‚

> ğŸ§‘â€ğŸ«**æ·±å…¥äº†è§£**: æƒ³äº†è§£æ›´å¤š AI Agents çš„åŸºæœ¬æ¦‚å¿µï¼Œå¯ä»¥åƒè€ƒ [Generative AI for Beginners: AI Agents](https://github.com/microsoft/generative-ai-for-beginners/tree/main/17-ai-agents)ã€‚

## å»ºç«‹ä¸€å€‹ AI Agent

æˆ‘å€‘å°‡å¼•å…¥ä¸€äº›æ–°æ¦‚å¿µä¾†åœ¨ .NET ä¸­æ§‹å»º AI Agentã€‚æˆ‘å€‘æœƒä½¿ç”¨ä¸€å€‹æ–°çš„ SDKï¼Œä¸¦éœ€è¦åœ¨ Azure AI Foundry ä¸­é€²è¡Œä¸€äº›é¡å¤–çš„è¨­å®šä¾†å•Ÿå‹•é …ç›®ã€‚

> ğŸ§‘â€ğŸ’»**ç¯„ä¾‹ç¨‹å¼ç¢¼**: æœ¬èª²ç¨‹å°‡ä½¿ç”¨ [AgentLabs-01-Simple sample](../../../03-CoreGenerativeAITechniques/src/AgentLabs-01-Simple) ä½œç‚ºç¯„ä¾‹ã€‚
>
> æˆ‘å€‘ä¹Ÿæä¾›äº†ä¸€äº›é€²éšç¯„ä¾‹ï¼Œä½æ–¼ `/src/` è³‡æ–™å¤¾ä¸­ã€‚ä½ å¯ä»¥æŸ¥çœ‹ [AgentLabs-02-Functions](../../../03-CoreGenerativeAITechniques/src/AgentLabs-02-Functions)ã€[AgentLabs-03-OpenAPIs](../../../03-CoreGenerativeAITechniques/src/AgentLabs-03-OpenAPIs) æˆ– [AgentLabs-03-PythonParksInformationServer](../../../03-CoreGenerativeAITechniques/src/AgentLabs-03-PythonParksInformationServer) çš„ README ä»¥ç²å–æ›´å¤šè³‡è¨Šã€‚

### Azure AI Agent Service

æˆ‘å€‘å°‡ä»‹ç´¹ä¸€å€‹æ–°çš„ Azure æœå‹™ä¾†å¹«åŠ©æˆ‘å€‘æ§‹å»ºä»£ç†ï¼Œä¹Ÿå°±æ˜¯å‘½åæ°ç•¶çš„ [Azure AI Agent Service](https://learn.microsoft.com/azure/ai-services/agents/overview)ã€‚

è¦é‹è¡Œæœ¬èª²ç¨‹ä¸­çš„ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼Œä½ éœ€è¦åœ¨ Azure AI Foundry ä¸­é€²è¡Œä¸€äº›é¡å¤–çš„è¨­å®šã€‚ä½ å¯ä»¥åƒè€ƒ [é€™äº›æŒ‡å¼•ä¾†è¨­å®šä¸€å€‹ **åŸºæœ¬ä»£ç†**](https://learn.microsoft.com/azure/ai-services/agents/quickstart?pivots=programming-language-csharp)ã€‚

### Azure AI Projects library

ä»£ç†ç”±ä¸‰å€‹éƒ¨åˆ†çµ„æˆï¼š**LLM** æˆ–æ¨¡å‹ã€**State** æˆ–ä¸Šä¸‹æ–‡ï¼ˆé¡ä¼¼æ–¼å°è©±ï¼Œç”¨æ–¼æ ¹æ“šéå»çš„çµæœå¼•å°æ±ºç­–ï¼‰ï¼Œä»¥åŠ **Tools**ï¼Œé€™äº›å·¥å…·é¡ä¼¼æ–¼æˆ‘å€‘ä¹‹å‰å­¸åˆ°çš„ [å‡½æ•¸](./01-lm-completions-functions.md#function-calling)ï¼Œç”¨ä¾†åœ¨æ¨¡å‹å’Œå¤–éƒ¨ç³»çµ±ä¹‹é–“å»ºç«‹æ©‹æ¨‘ã€‚

ç†è«–ä¸Šï¼Œä½ å¯ä»¥ç”¨ä¹‹å‰å­¸åˆ°çš„çŸ¥è­˜ä¾†æ§‹å»º AI Agentsã€‚ä½† **Azure AI Projects for .NET** library æä¾›äº†ä¸€å€‹ APIï¼Œå¯ä»¥ç°¡åŒ–è¨±å¤šå¸¸è¦‹ä»»å‹™ï¼Œè®“é–‹ç™¼ä»£ç†è®Šå¾—æ›´åŠ å®¹æ˜“ã€‚

åœ¨ä½¿ç”¨ Azure AI Projects library æ™‚ï¼Œéœ€è¦äº†è§£å¹¾å€‹æ¦‚å¿µï¼ˆå°æ‡‰åˆ°é¡åˆ¥ï¼‰ï¼š

- `AgentClient`ï¼šè² è²¬å‰µå»ºä¸¦è¨—ç®¡ä»£ç†çš„æ•´é«”å®¢æˆ¶ç«¯ï¼Œç®¡ç†ä»£ç†é‹è¡Œçš„ç·šç¨‹ï¼Œä¸¦è™•ç†èˆ‡é›²ç«¯çš„é€£æ¥ã€‚
- `Agent`ï¼šåŒ…å«ä»£ç†è¦åŸ·è¡Œçš„æŒ‡ä»¤ä»¥åŠå®ƒå¯ä»¥ä½¿ç”¨çš„å·¥å…·å®šç¾©ã€‚
- `ThreadMessage`ï¼šé€™äº›æ˜¯æ¶ˆæ¯â€”â€”é¡ä¼¼æ–¼æˆ‘å€‘ä¹‹å‰å­¸åˆ°çš„æç¤ºâ€”â€”ç”¨ä¾†å‚³éçµ¦ä»£ç†ã€‚ä»£ç†ä¹Ÿæœƒå‰µå»º `ThreadMessage` å°è±¡ä¾†é€²è¡Œäº¤æµã€‚
- `ThreadRun`ï¼šä¸€å€‹ç·šç¨‹ï¼Œç”¨æ–¼å°‡æ¶ˆæ¯å‚³éçµ¦ä»£ç†ã€‚ç·šç¨‹å•Ÿå‹•å¾Œï¼Œå¯ä»¥æä¾›é¡å¤–æŒ‡ä»¤ï¼Œä¸¦ä¸”å¯ä»¥è¼ªè©¢å…¶ç‹€æ…‹ã€‚

è®“æˆ‘å€‘çœ‹çœ‹ä¸€å€‹ç°¡å–®çš„ç¯„ä¾‹ï¼

### å»ºç«‹ä¸€å€‹æ•¸å­¸ä»£ç†

æˆ‘å€‘å°‡æ§‹å»ºä¸€å€‹å–®ä¸€ç”¨é€”çš„ä»£ç†ï¼Œä½œç‚ºæ•¸å­¸å­¸ç”Ÿçš„è¼”å°å“¡ã€‚å®ƒçš„å”¯ä¸€ç›®æ¨™æ˜¯è§£æ±ºä¸¦è§£é‡‹ä½¿ç”¨è€…æå‡ºçš„æ•¸å­¸å•é¡Œã€‚

1. é¦–å…ˆï¼Œæˆ‘å€‘éœ€è¦å‰µå»ºä¸€å€‹ `AgentsClient` å°è±¡ï¼Œè² è²¬ç®¡ç†èˆ‡ Azure çš„é€£æ¥ã€ä»£ç†æœ¬èº«ã€ç·šç¨‹ã€æ¶ˆæ¯ç­‰ã€‚

    ```csharp
    string projectConnectionString = "< YOU GET THIS FROM THE PROJECT IN AI FOUNDRY >";
    AgentsClient client = new(projectConnectionString, new DefaultAzureCredential());
    ```

    ä½ å¯ä»¥åœ¨ AI Foundry ä¸­æ‰“é–‹ä½ å‰µå»ºçš„ Hubï¼Œç„¶å¾Œé¸æ“‡å°ˆæ¡ˆï¼Œåœ¨å³å´æ‰¾åˆ°å°ˆæ¡ˆé€£æ¥å­—ä¸²ã€‚

    ![AI Foundry å°ˆæ¡ˆé¦–é çš„æˆªåœ–ï¼Œå°ˆæ¡ˆé€£æ¥å­—ä¸²ä»¥ç´…è‰²æ¨™å‡º](../../../translated_images/project-connection-string.e9005630f6251f18a89cb8c08f54b33bc83e0765f4c4e4d694af2ff447c4dfef.tw.png)

2. æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘éœ€è¦å‰µå»ºé€™å€‹è¼”å°ä»£ç†ã€‚è¨˜ä½ï¼Œå®ƒæ‡‰è©²åªå°ˆæ³¨æ–¼ä¸€ä»¶äº‹ã€‚
   
    ```csharp
    Agent tutorAgent = (await client.CreateAgentAsync(
    model: "gpt-4o",
    name: "Math Tutor",
    instructions: "You are a personal math tutor. Write and run code to answer math questions.",
    tools: [new CodeInterpreterToolDefinition()])).Value;
    ```

    é€™è£¡éœ€è¦æ³¨æ„å¹¾é»ã€‚é¦–å…ˆæ˜¯ `tools` parameter. We're creating a `CodeInterpreterToolDefinition` object (that is apart of the **Azure.AI.Projects** SDK) that will allow the agent to create and execute code.

    > ğŸ—’ï¸**Note**: You can create your own tools too. See the [Functions](../../../03-CoreGenerativeAITechniques/src/AgentLabs-02-Functions) to learn more.

    Second note the `instructions` that are being sent along. It's a prompt and we're limiting it to answer math questions. Then last creating the agent is an async operation. That's because it's creating an object within Azure AI Foundry Agents service. So we both `await` the `CreateAgentAsync` function and then grab the `Value` çš„è¿”å›å€¼ä¾†ç²å–å¯¦éš›çš„ `Agent` å°è±¡ã€‚åœ¨ä½¿ç”¨ **Azure.AI.Projects** SDK å‰µå»ºå°è±¡æ™‚ï¼Œä½ æœƒå¤šæ¬¡çœ‹åˆ°é€™æ¨£çš„æ¨¡å¼ã€‚

3. `AgentThread` æ˜¯è™•ç†å€‹åˆ¥ä»£ç†èˆ‡ä½¿ç”¨è€…ä¹‹é–“é€šä¿¡çš„å°è±¡ã€‚æˆ‘å€‘éœ€è¦å‰µå»ºå®ƒï¼Œç„¶å¾Œåœ¨ä¸Šé¢æ·»åŠ ä¸€å€‹ `ThreadMessage`ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œé€™æ˜¯ä½¿ç”¨è€…çš„ç¬¬ä¸€å€‹å•é¡Œã€‚

    ```csharp
    AgentThread thread = (await client.CreateThreadAsync()).Value;

    // Creating the first user message to AN agent - notice how we're putting it on a thread
    ThreadMessage userMessage = (await client.CreateMessageAsync(
        thread.Id,
        MessageRole.User,
        "Hello, I need to solve the equation `3x + 11 = 14`. Can you help me?")
    ).Value;
    ```

    æ³¨æ„ `ThreadMessage` çš„é¡å‹æ˜¯ `MessageRole.User`ã€‚ä¸¦ä¸”æˆ‘å€‘ä¸¦ä¸æ˜¯å°‡æ¶ˆæ¯ç™¼é€çµ¦ç‰¹å®šä»£ç†ï¼Œè€Œæ˜¯å°‡å…¶æ”¾åˆ°ä¸€å€‹ç·šç¨‹ä¸Šã€‚

4. æ¥ä¸‹ä¾†ï¼Œæˆ‘å€‘è®“ä»£ç†æä¾›ä¸€å€‹åˆå§‹å›æ‡‰ï¼Œå°‡å…¶æ”¾åˆ°ç·šç¨‹ä¸Šï¼Œç„¶å¾Œå•Ÿå‹•ç·šç¨‹ã€‚åœ¨å•Ÿå‹•ç·šç¨‹æ™‚ï¼Œæˆ‘å€‘æœƒæä¾›åˆå§‹ä»£ç†çš„ id ä¾†é‹è¡Œï¼Œä»¥åŠä»»ä½•é¡å¤–æŒ‡ä»¤ã€‚

    ```csharp
    ThreadMessage agentMessage =  await client.CreateMessageAsync(
        thread.Id,
        MessageRole.Agent,
        "Please address the user as their name. The user has a basic account, so just share the answer to the question.")
    ).Value;

    ThreadRun run = (await client.CreateRunAsync(
        thread.Id,
        assistantId: agentMathTutor.Id, 
        additionalInstructions: "You are working in FREE TIER EXPERIENCE mode`, every user has premium account for a short period of time. Explain detailed the steps to answer the user questions")
    ).Value;
    ```

5. æœ€å¾Œä¸€æ­¥æ˜¯æª¢æŸ¥é‹è¡Œçš„ç‹€æ…‹ã€‚

    ```csharp
    do
    {
        await Task.Delay(Timespan.FromMilliseconds(100));
        run = (await client.GetRunAsync(thread.Id, run.Id)).Value;

        Console.WriteLine($"Run Status: {run.Status}");
    }
    while (run.Status == RunStatus.Queued || run.Status == RunStatus.InProgress);
    ```

6. ç„¶å¾Œé¡¯ç¤ºçµæœä¸­çš„æ¶ˆæ¯ã€‚

    ```csharp
    Response<PageableList<ThreadMessage>> afterRunMessagesResponse = await client.GetMessagesAsync(thread.Id);
    IReadOnlyList<ThreadMessage> messages = afterRunMessagesResponse.Value.Data;

    // sort by creation date
    messages = messages.OrderBy(m => m.CreatedAt).ToList();

    foreach (ThreadMessage msg in messages)
    {
        Console.Write($"{msg.CreatedAt:yyyy-MM-dd HH:mm:ss} - {msg.Role,10}: ");

        foreach (MessageContent contentItem in msg.ContentItems)
        {
            if (contentItem is MessageTextContent textItem)
                Console.Write(textItem.Text);
        }
        Console.WriteLine();
    }
    ```

> ğŸ™‹ **éœ€è¦å¹«åŠ©å—ï¼Ÿ**: å¦‚æœé‡åˆ°ä»»ä½•å•é¡Œï¼Œ[åœ¨æ­¤å€‰åº«ä¸­æäº¤å•é¡Œ](https://github.com/microsoft/Generative-AI-for-beginners-dotnet/issues/new)ã€‚

ä¸‹ä¸€æ­¥çš„é‚è¼¯å¯èƒ½æ˜¯é–‹å§‹ä½¿ç”¨å¤šå€‹ä»£ç†ä¾†å‰µå»ºä¸€å€‹è‡ªå‹•åŒ–ç³»çµ±ã€‚ä¾‹å¦‚ï¼Œä¸‹ä¸€æ­¥å¯ä»¥æ§‹å»ºä¸€å€‹æª¢æŸ¥ä½¿ç”¨è€…æ˜¯å¦æ“æœ‰é«˜ç´šå¸³æˆ¶çš„ä»£ç†ã€‚

## ç¸½çµ

AI Agents æ˜¯è‡ªä¸»çš„ AI å¯¦é«”ï¼Œä¸åƒ…åƒ…å±€é™æ–¼ç°¡å–®çš„èŠå¤©äº’å‹•â€”â€”å®ƒå€‘å¯ä»¥ï¼š

- **ç¨ç«‹æ±ºç­–**ï¼šåœ¨ç„¡éœ€æŒçºŒäººå·¥è¼¸å…¥çš„æƒ…æ³ä¸‹åŸ·è¡Œä»»å‹™ã€‚
- **ç¶­æŒä¸Šä¸‹æ–‡**ï¼šä¿å­˜ç‹€æ…‹ä¸¦è¨˜ä½å…ˆå‰çš„äº’å‹•ã€‚
- **ä½¿ç”¨å·¥å…·**ï¼šè¨ªå•å¤–éƒ¨ç³»çµ±å’Œ API å®Œæˆä»»å‹™ã€‚
- **å”ä½œ**ï¼šèˆ‡å…¶ä»–ä»£ç†åˆä½œè§£æ±ºè¤‡é›œå•é¡Œã€‚

ä½ ä¹Ÿå­¸åˆ°äº†å¦‚ä½•ä½¿ç”¨ **Azure AI Agents** æœå‹™èˆ‡ **Azure AI Project** SDK ä¾†å‰µå»ºä¸€å€‹åŸºç¤ä»£ç†ã€‚

å°‡ä»£ç†æƒ³åƒæˆå…·æœ‰è¡Œå‹•èƒ½åŠ›çš„ AI åŠ©æ‰‹â€”â€”å®ƒå€‘ä¸åƒ…åƒ…æ˜¯å›æ‡‰ï¼Œé‚„æœƒæ ¹æ“šå…¶ç¨‹å¼è¨­è¨ˆå’Œç›®æ¨™æ¡å–è¡Œå‹•ã€‚

## å…¶ä»–è³‡æº

- [ä½¿ç”¨ .NET å»ºç«‹ä¸€å€‹ç°¡å–®ä»£ç†](https://learn.microsoft.com/dotnet/ai/quickstarts/quickstart-assistants?pivots=openai)
- [å¤šä»£ç†å”ä½œ](https://techcommunity.microsoft.com/blog/educatordeveloperblog/using-azure-ai-agent-service-with-autogen--semantic-kernel-to-build-a-multi-agen/4363121)
- [Semantic Kernel Agent Framework](https://learn.microsoft.com/semantic-kernel/frameworks/agent/?pivots=programming-language-csharp)
- [AI Agents - åˆå­¸è€…ç”Ÿæˆå¼ AI ç³»åˆ—](https://github.com/microsoft/generative-ai-for-beginners/tree/main/17-ai-agents)

## ä¸‹ä¸€æ­¥

ä½ å·²ç¶“å­¸åˆ°äº†å¾ˆå¤šï¼å¾ç°¡å–®çš„ä¸€æ¬¡æ€§æ–‡å­—è£œå…¨åˆ°æ§‹å»ºä»£ç†ï¼

ğŸ‘‰ [åœ¨ä¸‹ä¸€èª²ä¸­ï¼Œçœ‹çœ‹ä¸€äº›å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹](../04-PracticalSamples/readme.md)ï¼Œå­¸ç¿’å¦‚ä½•å°‡æ‰€æœ‰å…§å®¹çµåˆåœ¨ä¸€èµ·ã€‚

**å…è²¬è²æ˜**ï¼š  
æœ¬æ–‡æª”ä½¿ç”¨åŸºæ–¼æ©Ÿå™¨çš„äººå·¥æ™ºèƒ½ç¿»è­¯æœå‹™é€²è¡Œç¿»è­¯ã€‚å„˜ç®¡æˆ‘å€‘åŠªåŠ›ç¢ºä¿æº–ç¢ºæ€§ï¼Œä½†è«‹æ³¨æ„ï¼Œè‡ªå‹•ç¿»è­¯å¯èƒ½åŒ…å«éŒ¯èª¤æˆ–ä¸æº–ç¢ºä¹‹è™•ã€‚æ‡‰ä»¥åŸæ–‡æª”çš„æ¯èªç‰ˆæœ¬ç‚ºæ¬Šå¨ä¾†æºã€‚å°æ–¼é—œéµè³‡è¨Šï¼Œå»ºè­°å°‹æ±‚å°ˆæ¥­çš„äººé¡ç¿»è­¯ã€‚æˆ‘å€‘å°å› ä½¿ç”¨æ­¤ç¿»è­¯è€Œç”¢ç”Ÿçš„ä»»ä½•èª¤è§£æˆ–éŒ¯èª¤è§£é‡‹ä¸æ‰¿æ“”è²¬ä»»ã€‚